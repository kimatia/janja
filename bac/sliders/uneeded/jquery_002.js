
/*!
 * @package     pwebbox
 * @version 	2.0.9
 *
 * @copyright   Copyright (C) 2015 Perfect Web. All rights reserved. http://www.perfect-web.co
 * @license     GNU General Public Licence http://www.gnu.org/licenses/gpl-3.0.html
 * 
 * jQuery 1.8+
 */
var pwebBoxes=pwebBoxes||[],pwebbox_l10n=pwebbox_l10n||{};!function(o){pwebBox=function(o){this.init(o)},pwebBox.prototype=function(){return{constructor:pwebBox,defaults:{id:"",selector:"#pwebbox",selectorClass:".pwebbox",debug:!1,bootstrap:2,openAuto:!1,openDelay:0,maxAutoOpen:0,closeAuto:!1,closeDelay:0,closeOther:!0,layout:"slidebox",theme:"",position:"left",offsetPosition:"top",msgCloseDelay:10,togglerNameOpen:"",togglerNameClose:"",slideWidth:0,slideDuration:400,slideTransition:"swing",accordionDuration:500,accordionEaseIn:"easeInBack",accordionEaseOut:"easeOutBounce",modalBackdrop:!0,modalClose:!0,modalStyle:"default",modalEffect:"fade",modalEffectDuration:400,modalEaseIn:"easeInCubic",modalEaseOut:"easeOutCubic",cookieLifetime:30,cookiePath:"/",cookieDomain:"",onLoad:function(){},onOpen:function(){},onClose:function(){},onTrack:function(){}},status:0,hidden:!0,timer:!1,init:function(t){var i=this;if(this.options=o.extend({},this.defaults,t),this.options.selector=this.options.selector+this.options.id,this.options.selectorClass=this.options.selectorClass+this.options.id,this.element=o(this.options.selector),this.Content=o(this.options.selector+"_content"),this.Toggler=o(this.options.selector+"_toggler"),this.Box=o(this.options.selector+"_box"),this.Container=o(this.options.selector+"_container"),this.options.autoClose=this.options.closeDelay>0?!0:!1,this.options.tracked=!1,this.options.openEvent="click",this.Box.hasClass("pweb-open-event-mouseenter")&&(this.options.openEvent="mouseenter"),this.options.closeEvent="click",this.Box.hasClass("pweb-close-event-mouseleave")&&(this.options.closeEvent="mouseleave"),o("a[href="+this.options.selector+"_toggler]").addClass(this.options.selector.replace("#","")+"_toggler"),"slidebox"==this.options.layout)this.element.appendTo(document.body),this.initSlidebox();else if("modal"==this.options.layout){if(this.element.appendTo(document.body),!this.initModal())return!1}else"accordion"==this.options.layout&&this.initAccordion();this.options.onLoad.apply(this),this.element.trigger("onLoad");var e=!1;if(-1!==document.location.hash.indexOf(this.options.selector+":")){var s=document.location.hash.replace(this.options.selector+":","");0!==s.indexOf("open")||"undefined"!=typeof s[4]&&":"!=s[4]||(s=s.replace(/open(:)?/i,""),e=!0)}if("static"!=this.options.layout){if("click"==this.options.openEvent&&"click"==this.options.closeEvent)o(this.options.selectorClass+"_toggler").click(function(o){o.preventDefault(),i.toggleBox(-1,-1,this,o)});else if(this.Box.find(".pweb-button-close").click(function(o){o.preventDefault(),i.toggleBox(-1,-1,this,o)}),"mouseenter"==this.options.openEvent?o(this.Toggler).mouseenter(function(o){o.preventDefault(),i.toggleBox(1,1,this,o)}):o(this.Toggler).click(function(o){o.preventDefault(),i.toggleBox(1,1,this,o)}),"mouseleave"==this.options.closeEvent){var n=this.element;"modal"==this.options.layout&&(n=this.Box),o(n).mouseleave(function(o){i.Toggler.hasClass("pweb-opened")&&(o.preventDefault(),i.toggleBox(0,-1,this,o))})}else o(this.Toggler).click(function(o){i.Toggler.hasClass("pweb-opened")&&(o.preventDefault(),i.toggleBox(0,-1,this,o))});if(this.options.togglerNameClose&&(this.options.togglerNameOpen=this.Toggler.find(".pweb-text").text()),this.options.closeOther&&pwebBoxes.push(this),e)this.autoPopupOnPageLoad();else if(this.options.openAuto)switch(this.options.maxAutoOpen>0&&(this.initAutoPopupCookie()||(this.options.openAuto=!1)),this.options.openAuto){case 1:this.autoPopupOnPageLoad();break;case 2:this.autoPopupOnPageScroll();break;case 3:this.autoPopupOnPageExit()}if("bottombar"==i.options.layout){var p=o(i.options.selector).find(".pwebbox-container").outerHeight();i.Toggler.height(p).css("line-height",p+"px")}o(window).resize(function(){if("bottombar"==i.options.layout){var t=o(i.options.selector).find(".pwebbox-container").outerHeight();i.Toggler.height(t).css("line-height",t+"px")}})}return this.initHiddenFields(),this},initSlidebox:function(){var t=this;this.options.togglerSlide=this.Box.hasClass("pweb-toggler-slide"),this.options.togglerHidden=this.Box.hasClass("pweb-toggler-hidden"),this.options.slidePos=this.element.css("position"),this.options.slideWidth||(this.options.slideWidth=parseInt(this.Box.css("max-width"))),this.Box.css("width",this.options.slideWidth),"left"==this.options.position||"right"==this.options.position?(this.Box.css(this.options.position,-this.options.slideWidth),this.options.togglerWidth=this.options.togglerSlide?this.Toggler.outerWidth():0,this.options.togglerHeight=this.options.togglerSlide?parseInt(this.Box.css("top")):0,this.options.slideOffset=parseInt(this.element.css("top")),this.options.togglerSlide&&this.Toggler.css("left"==this.options.position?"right":"left",-this.Toggler.outerWidth())):(setTimeout(function(){t.Box.css(t.options.position,-t.Box.height())},100),this.options.togglerWidth=0,this.options.togglerHeight=this.options.togglerSlide?this.Toggler.outerHeight():0,this.options.slideOffset=0,this.options.togglerSlide&&this.Toggler.css("top"==this.options.position?"bottom":"top",-this.Toggler.outerHeight())),this.Box.addClass("pweb-closed"),setTimeout(function(){t.Box.removeClass("pweb-init")},100),this.options.togglerHidden&&(this.Toggler.fadeOut(0).removeClass("pweb-closed").addClass("pweb-opened"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameClose)),this.isFF=-1!=navigator.userAgent.indexOf("Gecko"),o(window).scroll(function(i){if(!t.hidden&&"absolute"==t.element.css("position")&&"fixed"==t.options.slidePos){var e=o(this).scrollTop();"bottom"==t.options.position?(e+=o(this).height(),e>t.element.offset().top&&(t.isFF?t.element.css("top",e):t.element.stop().animate({top:e},250,"linear"))):(e+=t.options.slideOffset,e<t.element.offset().top&&(t.isFF?t.element.css("top",e):t.element.stop().animate({top:e},250,"linear")))}}),o(window).resize(function(){if(!t.hidden){var i={width:t.options.slideWidth},e=o(window).width();if("left"==t.options.position||"right"==t.options.position)t.options.slideWidth+t.options.togglerWidth>e&&(i.width=e-t.options.togglerWidth);else{var s=t.element.offset().left;"right"==t.options.offsetPosition&&(s=o(document).width()-s),t.options.slideWidth+s>e&&(i.width=e-s)}if(t.Box.css(i),"fixed"==t.options.slidePos){var i={position:"absolute"};"left"==t.options.position||"right"==t.options.position?(i.top=t.element.offset().top,t.Box.height()+t.options.togglerHeight+i.top-o(window).scrollTop()<=o(window).height()&&(i.position="fixed",i.top=t.options.slideOffset)):t.Box.height()+t.options.togglerHeight>o(window).height()?(i.top=t.element.offset().top,"bottom"==t.options.position&&(i.bottom="auto")):(i.position="fixed",i[t.options.position]=0,"bottom"==t.options.position&&(i.top="auto")),t.element.css(i)}}})},initModal:function(){var t=this;return"function"==typeof o.fn.modal?(this.Modal=o(this.options.selector+"_modal"),this.options.modalClass="pwebbox"+this.options.id+"_modal-open pweb-modal-open"+(this.options.theme?" pweb-theme-"+this.options.theme+"-modal":"")+" pweb-modal-"+this.options.modalStyle,this.Modal.appendTo(document.body).modal({show:!1,keyboard:!1,backdrop:!this.options.modalClose&&this.options.modalBackdrop?"static":this.options.modalBackdrop}).on(2===this.options.bootstrap?"hidden":"hidden.bs.modal",function(i){i.stopPropagation(),i.target===i.currentTarget&&(t.toggleBox(0),o(document.body).removeClass(t.options.modalClass),t.Box.addClass("pweb-closed"))}).on(2===this.options.bootstrap?"show":"show.bs.modal",function(i){i.stopPropagation(),i.target===i.currentTarget&&(o(document.body).addClass(t.options.modalClass),t.Box.removeClass("pweb-closed"))}).click(function(o){o.target===o.currentTarget&&t.options.modalClose&&t.toggleBox(0)}),"fade"!==this.options.modalEffect&&"drop"!==this.options.modalEffect&&this.initGenie(),!0):(this.options.debug&&this.debug("Bootstrap Modal Plugin is not loaded"),!1)},initGenie:function(){var t=this,i=this.Box.attr("class").match(/pweb-bg-[a-z]+/i);this.options.modalGenieClass="pweb-genie pweb-"+this.options.modalEffect+"-"+("static"!==this.options.position?this.options.position:"bottom")+" pwebbox"+this.options.id+"-genie"+(this.options.theme?" pweb-theme-"+this.options.theme:"")+(this.Box.hasClass("pweb-radius")?" pweb-radius":"")+(this.Box.hasClass("pweb-shadow")?" pweb-shadow":"")+(i?" "+i[0]:""),"smooth"===this.options.modalEffect?(this.options.modalEaseIn="easeInQuart",this.options.modalEaseOut="easeOutQuart"):"rotate"===this.options.modalEffect&&(this.options.modalEaseIn="easeInQuint",this.options.modalEaseOut="easeOutQuint"),this.Modal.on(2===this.options.bootstrap?"show":"show.bs.modal",function(i){i.stopPropagation(),i.target===i.currentTarget&&"undefined"!=typeof t.eventSource&&o(t.eventSource).length&&t.Container.css({visibility:"hidden",opacity:0})}).on(2===this.options.bootstrap?"shown":"shown.bs.modal",function(i){i.stopPropagation(),i.target===i.currentTarget&&"undefined"!=typeof t.eventSource&&o(t.eventSource).length&&o(t.eventSource).trigger("modalOpen")}),o(this.options.selectorClass+"_toggler").on("modalOpen",function(){o(this).effect({effect:"transfer",to:t.Container,duration:t.options.modalEffectDuration,easing:t.options.modalEaseIn,className:"pweb-genie-show "+t.options.modalGenieClass,complete:function(){t.Container.css({visibility:"visible",opacity:1})}})}),this.Container.on("modalClose",function(){o(this).css({visibility:"hidden",opacity:0}).effect({effect:"transfer",to:o(t.eventSource),duration:t.options.modalEffectDuration,easing:t.options.modalEaseOut,className:"pweb-genie-hide "+t.options.modalGenieClass,complete:function(){t.Modal.modal("hide")}})})},initAccordion:function(){var t=this;return o(this.options.selectorClass+"_toggler").on("openAccordion",function(){t.Box.removeClass("pweb-closed").slideDown({duration:t.options.accordionDuration,easing:t.options.accordionEaseOut,complete:function(){var i=o(window).height(),e=t.element.outerHeight(),s=t.element.offset().top;s+e>o(window).scrollTop()+i&&(i>e&&(s=s+e-i),o("html,body").animate({scrollTop:parseInt(s)},500)),o(t.Toggler).trigger("openedAccordion")}})}),o(this.element).on("closeAccordion",function(){t.Box.slideUp({duration:t.options.accordionDuration,easing:t.options.accordionEaseIn,complete:function(){t.Box.addClass("pweb-closed")}})}),this.Box.css("display","none").removeClass("pweb-init"),!0},initHiddenFields:function(){return o("<input/>",{type:"hidden",name:"screen_resolution",value:screen.width+"x"+screen.height}).appendTo(this.Content),this.options.debug&&o("<input/>",{type:"hidden",name:"debug",value:1}).appendTo(this.Content),!0},close:function(){this.toggleBox(0)},toggleBox:function(t,i,e,s){var n=this;if("undefined"==typeof t&&(t=-1),"undefined"==typeof e&&(e=this.Toggler),this.hidden||-1!==t&&0!==t){if(this.hidden&&(-1===t||1===t)){if(this.options.closeOther&&o.each(pwebBoxes,function(){this.options.id!=n.options.id&&"function"==typeof this.close&&this.close()}),(1===this.options.openAuto||2===this.options.openAuto)&&(this.options.openAuto=!1,this.timer&&clearTimeout(this.timer)),this.hidden=!1,this.Toggler.length&&!this.options.togglerHidden&&(this.Toggler.removeClass("pweb-closed").addClass("pweb-opened"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameClose)),"slidebox"==this.options.layout){var p={width:this.options.slideWidth};p[this.options.position]=0;var l=o(window).width();if("left"==this.options.position||"right"==this.options.position)this.options.slideWidth+this.options.togglerWidth>l&&(p.width=l-this.options.togglerWidth);else{var a=this.element.offset().left;"right"==this.options.offsetPosition&&(a=o(document).width()-a),this.options.slideWidth+a>l&&(p.width=l-a)}this.Box.stop(!0,!1).animate(p,this.options.slideDuration,this.options.slideTransition,function(){if("fixed"==n.options.slidePos){var t={position:"absolute"};"left"==n.options.position||"right"==n.options.position?(t.top=n.element.offset().top,n.Box.height()+n.options.togglerHeight+t.top-o(window).scrollTop()>o(window).height()&&(t.top=n.element.offset().top,n.element.css(t))):n.Box.height()+n.options.togglerHeight>o(window).height()&&(t.top=n.element.offset().top,"bottom"==n.options.position&&(t.bottom="auto"),n.element.css(t))}o(e).trigger("shownSlidebox")}).css("overflow","visible").removeClass("pweb-closed"),this.options.togglerHidden&&this.Toggler.fadeIn(this.options.slideDuration)}else"modal"==this.options.layout?("fade"!==this.options.modalEffect&&"drop"!==this.options.modalEffect&&o(e).length&&(this.eventSource=e),this.Modal.modal("show")):"accordion"==this.options.layout?o(e).trigger("openAccordion"):"bottombar"==this.options.layout&&this.Box.parent().show();this.options.onOpen.apply(this),this.element.trigger("onOpen"),this.options.tracked||(this.options.tracked=!0,this.options.onTrack.apply(this),this.element.trigger("onTrack")),this.autoClose()}}else{if(this.hidden=!0,this.Toggler.length&&!this.options.togglerHidden&&(this.Toggler.removeClass("pweb-opened").addClass("pweb-closed"),this.options.togglerNameClose&&this.Toggler.find(".pweb-text").text(this.options.togglerNameOpen)),this.options.openAuto===!1&&this.timer&&clearTimeout(this.timer),"slidebox"==this.options.layout){var p={};p[this.options.position]="left"==this.options.position||"right"==this.options.position?-this.Box.width():-this.Box.height(),this.Box.stop(!0,!1).animate(p,this.options.slideDuration,this.options.slideTransition,function(){if(n.Box.addClass("pweb-closed"),"absolute"==n.element.css("position")&&"fixed"==n.options.slidePos){var t={position:"fixed"};"left"==n.options.position||"right"==n.options.position?t.top=n.options.slideOffset:(t[n.options.position]=0,"bottom"==n.options.position&&(t.top="auto")),n.element.css(t)}o(e).trigger("closedSlidebox")}),this.options.togglerHidden&&this.Toggler.fadeOut(this.options.slideDuration)}else"modal"==this.options.layout?"fade"!==this.options.modalEffect&&"drop"!==this.options.modalEffect&&"undefined"!=typeof this.eventSource?this.Container.trigger("modalClose"):this.Modal.modal("hide"):"accordion"==this.options.layout?o(e).trigger("closeAccordion"):"bottombar"==this.options.layout&&this.element.hide();this.options.onClose.apply(this),this.element.trigger("onClose")}},initAutoPopupCookie:function(){if("function"==typeof o.cookie){var t=parseInt(o.cookie("pwebbox"+this.options.id+"_openauto"));if(t=isNaN(t)?1:t+1,t<=this.options.maxAutoOpen)return o.cookie("pwebbox"+this.options.id+"_openauto",t,{domain:this.options.cookieDomain,path:this.options.cookiePath,expires:this.options.cookieLifetime}),!0}else this.options.debug&&this.debug("jQuery Cookie Plugin is not loaded");return!1},autoPopupOnPageLoad:function(){this.options.openDelay?this.timer=this.delay(this.toggleBox,this.options.openDelay,this,[1]):this.toggleBox(1)},autoPopupOnPageScroll:function(){var t=this;this.autoOpen=!0,o(window).scroll(function(){t.autoOpen&&(t.autoOpen=!1,t.options.openDelay?t.timer=t.delay(t.toggleBox,t.options.openDelay,t,[1]):t.toggleBox(1))})},autoPopupOnPageExit:function(){var t=this;this.autoOpen=-1,o(window).mousemove(function(o){-1==t.autoOpen&&o.clientY>70?t.autoOpen=1:1==t.autoOpen&&o.clientY<30&&(t.autoOpen=0,t.options.openDelay?t.timer=t.delay(t.toggleBox,t.options.openDelay,t,[1]):t.toggleBox(1))})},autoClose:function(){this.options.autoClose&&(this.options.closeDelay?this.timer=this.delay(this.toggleBox,this.options.closeDelay,this,[0]):this.toggleBox(0))},delay:function(o,t,i,e){return setTimeout(function(){return o.apply(i,e||arguments)},t)},displayAlert:function(t,i,e,s){if("function"==typeof o.fn.alert){var n=o('<div class="pweb-alert alert alert-block '+(i?"alert-"+i:"")+' fade in"><button data-dismiss="alert" class="close" type="button">&times;</button>'+("undefined"!=typeof e?'<h4 class="alert-heading">'+e+"</h4>":"")+"<p>"+t+"</p></div>").alert().appendTo(document.body);("undefined"==typeof s||s)&&this.options.msgCloseDelay&&setTimeout(function(){n.alert("close")},1e3*this.options.msgCloseDelay)}else alert(t.replace("<br>","\r\n"))},debug:function(t,i){o.isArray(t)&&(t=t.join("<br>")),"undefined"!=typeof i&&(t=t+"<br>Response code: "+i),this.displayAlert(t,"info","Perfect Popup Box",!1)}}}(),pwebBox.options=pwebBox.prototype.options}(window.jQuery);